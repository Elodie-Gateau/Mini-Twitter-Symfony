{% extends 'base.html.twig' %}

{% block title %}Profil de {{user.name}} {{user.firstName}} {% endblock %}

{% block body %}


	<section class="bg-gray-100 p-4 sm:p-6 md:p-8 lg:p-10"> 


	{# Card Profil de l'user connecté #}
		<div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden md:flex">
			<div class="md:flex-shrink-0 p-6 flex flex-col items-center justify-center bg-gradient-to-br from-blue-500 to-indigo-600 text-white rounded-t-xl md:rounded-l-xl md:rounded-tr-none">
				<img class="h-24 w-24 rounded-full object-cover border-4 border-white shadow-md mb-4"  src="{{ asset('uploads/photos/' ~ user.photo) }}" alt="Photo de profil de l'utilisateur">
				<h1 class="text-3xl font-extrabold text-center">{{ user.name }}</h1>
				<p class="text-lg font-light text-center opacity-90">@{{ user.nickname }}</p>
			</div>

			<div class="p-6 md:p-8 flex-1">
				<h2 class="text-2xl font-semibold text-gray-800 mb-6 border-b-2 border-blue-200 pb-2">Informations du profil</h2>
				<div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-700">

					<p>
						<strong class="font-medium text-gray-900">Nom de l'utilisateur :</strong>
						{{ user.name }}</p>
					<p>
						<strong class="font-medium text-gray-900">Prénom de l'utilisateur :</strong>
						{{ user.firstName }}</p>
					<p>
						<strong class="font-medium text-gray-900">Pseudo de l'utilisateur :</strong>
						{{ user.nickName }}</p>
					<p>
						<strong class="font-medium text-gray-900">Âge de l'utilisateur :</strong>
						{{ user.age }} ans</p>

					<p class="md:col-span-1">
						<strong class="font-medium text-gray-900">Email de l'utilisateur :</strong>
						{{ user.email }}</p>
					
					{% if is_granted('ROLE_ADMIN') %}
					<p class="md:col-span-1">
						<strong class="font-medium text-gray-900">Utilisateur administrateur :</strong> Oui</p>
					{% endif %}


				</div>
				<div class="flex justify-center">
   					 <a href="{{ path('app_profile_edit', {'id': app.user.id}) }}" 
      					class="bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-1 px-3 mt-7 border border-blue-500 hover:border-transparent rounded text-center inline-block">
       					 Modifier le profil
    				</a>
				</div>
			</div>
		</div>

<!-- Page Content -->
			<main id="page-content" class="flex max-w-full flex-auto flex-col">
				<div class="container mx-auto p-4 lg:p-8 xl:max-w-7xl">
					<div
						class="grid grid-cols-1 md:gap-20 lg:grid-cols-12">
						<!-- Navigation -->
						<nav class="hidden lg:col-span-3 lg:block">
							<hr class="h-5 border-0"/>

							<hr class="h-5 border-0"/>
							<div class="space-y-1.5">

								<a href="{{ path('app_profile_show', {'id': app.user.id,'section': 'tweets'}) }}" class="group flex items-center justify-between gap-2 rounded-md border border-transparent px-2.5 py-2 text-sm font-semibold text-slate-900 hover:bg-indigo-100 hover:text-indigo-600 active:border-indigo-200">
									<i class="fa-solid fa-message hi-mini hi-briefcase inline-block size-5 flex-none text-slate-300 group-hover:text-indigo-500"></i>
									<span class="grow">Mes tweets</span>
									<span class="inline-flex items-center justify-center rounded-full border border-indigo-200 bg-indigo-50 px-1 text-xs text-indigo-900">{{ app.user.tweets|length }}</span>
								</a>
								<a href="{{ path('app_profile_show', {'id': app.user.id,'section': 'likes'}) }}" class="group flex items-center justify-between gap-2 rounded-md border border-transparent px-2.5 py-2 text-sm font-semibold text-slate-900 hover:bg-indigo-100 hover:text-indigo-600 active:border-indigo-200">
									<i class="fa-solid fa-paw hi-mini hi-user-group inline-block size-5 flex-none text-slate-300 group-hover:text-indigo-500"></i>
									<span class="grow">Mes Likes</span>
									<span class="inline-flex items-center justify-center rounded-full border border-indigo-200 bg-indigo-50 px-1 text-xs text-indigo-900">{{ app.user.likes|length }}</span>
								</a>
							</div>
							<hr class="h-5 border-0"/>

						</nav>
						<!-- END Navigation -->

						<!-- Main Content -->
						{% if app.request.query.get('section') == 'tweets' or app.request.query.get('section') is null %}
								<div class="overflow-hidden rounded-xl border border-slate-200 bg-white lg:col-span-9">
									<div class="px-6 pt-6">
										<h2 class="text-2xl font-bold">Mes tweets</h2>
										<h3
											class="text-sm font-medium text-slate-500">
										</h3>
									</div>
									<div
										class="p-6">
										<!-- Responsive Table Container -->
										<div
											class="min-w-full overflow-x-auto rounded-sm  flex flex-col gap-3">
											<!-- Alternate Responsive Table -->
											<table
												class="min-w-full align-middle text-sm  flex flex-col gap-3">
												<!-- Table Body -->
												<tbody>

														<tr class="group border-b border-slate-100">
															{% if user.tweets is not empty %}
															{% for tweet in user.tweets %}
								{# Tri par ordre antichronologique : ajout d'un order by dans l'entité User sur relation Tweet #}
															<a href="{{ path('app_tweet_show', {'id': tweet.id}) }}" class="block no-underline">
															<div class="bg-blue-50 p-4 rounded-lg mb-4 last:mb-0 border border-blue-200">
																<p class="text-gray-800 mb-2">{{ tweet.content }}</p>
																<div class="flex justify-between">
																<small class="text-gray-500 text-sm">Publié le
																	{{ tweet.creationtime|date('d/m/Y H:i') }}</small>
																<small class="text-gray-500 text-sm">{{ tweet.comment|length}} commentaire{{tweet.comment|length > 1 ? "s" : ""}}</small>
																<small class="text-gray-500 text-sm">	{{ tweet.likes|length }} <i class="fa-solid fa-paw "></i></small>
																	</div>
																	</div>
															{% endfor %}
															{% else %}
															<p class="text-gray-600 italic">Vous n'avez pas encore publié de tweets.</p>
															{% endif %}
														</tr>
						
												</tbody>
												<!-- END Table Body -->
											</tbody>
										</table>
										<!-- END Alternate Responsive Table -->
									</div>
									<!-- END Responsive Table Container -->
								</div>
							</div>
							{% elseif app.request.query.get('section') == 'likes' %}
															<div class="overflow-hidden rounded-xl border border-slate-200 bg-white lg:col-span-9">
									<div class="px-6 pt-6">
										<h2 class="text-2xl font-bold">Mes likes</h2>
										<h3
											class="text-sm font-medium text-slate-500">
										</h3>
									</div>
									<div
										class="p-6">
										<!-- Responsive Table Container -->
										<div
											class="min-w-full overflow-x-auto rounded-sm  flex flex-col gap-3">
											<!-- Alternate Responsive Table -->
											<table
												class="min-w-full align-middle text-sm  flex flex-col gap-3">
												<!-- Table Body -->
												<tbody>

														<tr class="group border-b border-slate-100">
															{% if user.likes is not empty %}
													{% for like in user.likes %}
    												{% set tweet = like.tweet %}
								{# Tri par ordre antichronologique : ajout d'un order by dans l'entité User sur relation Tweet #}
															<a href="{{ path('app_tweet_show', {'id': tweet.id}) }}" class="block no-underline">
															<div class="bg-blue-50 p-4 rounded-lg mb-4 last:mb-0 border border-blue-200">
																<p class="text-gray-800 mb-2"><strong>{{ tweet.idUser.isActive ? tweet.idUser.nickname : "Utilisateur anonyme" }}</strong></p>
																<p class="text-gray-800 mb-2">{{ tweet.content }}</p>
																<div class="flex justify-between">
																<small class="text-gray-500 text-sm">Publié le
																	{{ tweet.creationtime|date('d/m/Y H:i') }}</small>
																	<small class="text-gray-500 text-sm">{{ tweet.comment|length}} commentaire{{tweet.comment|length > 1 ? "s" : ""}}</small>
																<small class="text-gray-500 text-sm">	{{ tweet.likes|length }} <i class="fa-solid fa-paw "></i></small>
																	</div>
																	</div>
															{% endfor %}
															{% else %}
															<p class="text-gray-600 italic">Vous n'avez pas encore liké de tweets.</p>
															{% endif %}
														</tr>
						
												</tbody>
												<!-- END Table Body -->
											</tbody>
										</table>
										<!-- END Alternate Responsive Table -->
									</div>
									<!-- END Responsive Table Container -->
								</div>
								      {% endif %}
							</div>
						</div>

					<!-- END Main Content -->


		<div class="max-w-4xl mx-auto mt-8 flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-4">
			<a href="{{ path('app_tweet_index')}}" class="bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded cursor-pointer mt-2">
				Retour à l'Accueil
			</a>

		</div>

	</section>
{% endblock %}
