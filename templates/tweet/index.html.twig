{% extends 'base.html.twig' %}

{% block title %}Tweet actus
{% endblock %}

{% block body %}


	<section class="timeline flex flex-col items-center gap-5 py-8">
  {# Bouton créer un tweet #}
		<a class="bg-orange-500 hover:bg-orange-500 text-white font-bold py-2 px-4 border border-orange-700 rounded" href="{{ path('app_tweet_new') }}">Créer un tweet</a>

		{% for tweet in tweets %}
{# Cards tweet #}

			<div class="w-100 rounded-xl shadow-lg p-5 flex flex-col items-center">

  {# Entête de card #}
				<div class="flex w-100 justify-between p-5">

          <div class="flex gap-3 items-center">
          {# Photo de profil #}
					{% if tweet.idUser.photo %}
						<img class="w-10 h-10 rounded mr-2" src="{{ tweet.idUser.photo }}" alt="Photo de {{ tweet.idUser.name }}">
          {% else %}
            <img class = "w-10 h-10 rounded mr-2" src="{{ asset('img/personne.png') }}" alt="Photo de {{ tweet.idUser.name }}">
          {% endif %}

          {# Nom et date du tweet #}
					  <div class="flex flex-col">
						  <h2 class="font-bold text-xl mb-1">{{ tweet.idUser.nickname }}</h2>
						  <h3>{{ tweet.creationTime ? tweet.creationTime|date('d F, H:i', 'Europe/Paris', 'fr') : '' }}</h3>
					  </div>

          </div>
          {# Bouton modifier tweet #}
					<a class="self-center font-bold text-orange-500" href="{{ path('app_tweet_edit', {'id': tweet.id}) }}">Modifier</a>

				</div>

  {# Contenu du tweet #}
				<p class="text-gray-700 text-base self-start py-7">
					{{ tweet.content }}
				</p>


				{# <div class="px-6 pt-4 pb-2">
				    <span class="inline-block bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2">#tag</span>
				    <span class="inline-block bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2">#tag</span>
				    <span class="inline-block bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2">#tag</span>
				  </div>  #}

  {# Media du tweet #}
				<div class= "flex w-100 justify-center gap-1 p-6 flex-wrap">
					{% if tweet.media|length > 0 %}
						{% for media in tweet.media %}

							<img class="w-{{ tweet.media|length > 1 ? "40" : "100" }}" src="{{ media.urlMedia }}" alt="">

						{% endfor %}
					{% endif %}
				</div>

  {# Commentaires #}
        <div class="self-start p-7">
				  <a class="" href="{{ path('app_tweet_index_comment', {'id': tweet.id}) }}">
					  {{ tweet.comment|length }}
					  commentaire{{ tweet.comment|length > 1 ? "s" : "" }}
				  </a>
        </div>

				{% if selectedTweet is defined and selectedTweet.id == tweet.id %}
				<div class=" w-90 p-4 bg-gray-100 rounded">
						<h4 class="font-semibold mb-2">Commentaires :</h4>

						{% for comment in selectedTweet.comment %}
							<div class="mb-2 border-b pb-2">
              <div class="flex justify-between">
								<p class="text-sm text-gray-700 font-semibold">{{ comment.user.nickname }}</p>
								<p class="text-sm text-gray-700 font-semibold">{{ comment.dateTime|date('d F, H:i', 'Europe/Paris', 'fr') }}</p>
              </div>
								<p>{{ comment.content }}</p>
							</div>
						{% else %}
							<p class="text-sm text-gray-500">Aucun commentaire pour ce tweet.</p>
						{% endfor %}

						<h5 class="mt-4 mb-3 font-semibold">Ajouter un commentaire :</h5>
            {{ include('comment/_form.html.twig') }}
					</div>
				{% endif %}
			</div>

		{% else %}

			<p colspan="4">Aucun tweet trouvé</p>

		{% endfor %}


	</section>
{% endblock %}
