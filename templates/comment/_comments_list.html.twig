{# Formulaire de création de commentaire #}
{% if app.user %}
  <div class="mb-4">
    {{ include('comment/_add_form.html.twig', { form: commentForm, tweet: tweet }) }}
  </div>
{% endif %}

{# Liste des commentaires #}
{% for comment in comments %}
<div id="comment-{{ comment.id }}" class="py-4 border-t border-gray-200 dark:border-slate-600">
  <div class="flex justify-between items-center">
    <div class="flex items-center gap-2">
      {% if comment.user.photo %}
        <img class="w-8 h-8 rounded-full" src="{{ asset('uploads/photos/' ~ comment.user.photo) }}" alt="">
      {% else %}
        <img class="w-8 h-8 rounded-full" src="{{ asset('img/personne.png') }}" alt="">
      {% endif %}
      <p class="text-sm font-medium">{{ comment.user.isActive ? comment.user.nickname : "Utilisateur anonyme" }}</p>
    </div>
    <p class="text-xs text-gray-500">{{ comment.dateTime|date('d/m/Y H:i') }}</p>
  </div>

  <p class="mt-2 text-gray-700 dark:text-gray-300">{{ comment.content }}</p>

  {% if comment.media|length > 0 %}
    <div class="flex gap-2 flex-wrap mt-2">
      {% for media in comment.media %}
        <img class="rounded-lg border {{ comment.media|length > 1 ? 'w-40' : 'w-full' }}"
             src="{{ media.urlMedia }}" alt="">
      {% endfor %}
    </div>
  {% endif %}

  <div class="flex justify-between items-center mt-2 text-xs">
    {# Liker le commentaire #}
    {{ include('comment/_like_form.html.twig') }}

    {# Signaler le commentaire #}
    {% if app.user and app.user.id != comment.user.id %}
      {{ include('comment/_signal_form.html.twig') }}
    {% endif %}

    {# Modifier / Supprimer si propriétaire #}
    {% if app.user and app.user.id == comment.user.id %}
      <a href="{{ path('app_comment_edit', {'id': comment.id}) }}" class="text-blue-500 hover:underline">Modifier</a>
      {{ include('comment/_delete_form.html.twig') }}
    {% endif %}
  </div>
</div>
{% else %}
<p class="text-sm text-gray-500">Aucun commentaire pour ce tweet.</p>
{% endfor %}